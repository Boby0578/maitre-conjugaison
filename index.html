<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma√Ætre de la Conjugaison</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 90%;
            text-align: center;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .menu-screen, .game-screen, .score-screen {
            display: none;
        }

        .menu-screen.active, .game-screen.active, .score-screen.active {
            display: block;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.level {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            width: 200px;
        }

        .btn.micro {
            background: linear-gradient(45deg, #27ae60, #229954);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 1.5em;
        }

        .btn.micro:hover {
            background: linear-gradient(45deg, #229954, #1e8449);
        }

        .question {
            font-size: 1.5em;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .verb { color: #e74c3c; }
        .tense { color: #3498db; }
        .pronoun { color: #27ae60; }

        .answer-input {
            font-size: 1.3em;
            padding: 15px;
            border: 3px solid #3498db;
            border-radius: 10px;
            width: 300px;
            margin: 20px 0;
        }

        .score {
            font-size: 1.5em;
            color: #2c3e50;
            margin: 20px 0;
        }

        .message {
            font-size: 1.3em;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
        }

        .success {
            background: linear-gradient(45deg, #27ae60, #229954);
            color: white;
        }

        .error {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        .conjugation-table {
            display: none;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .conjugation-table.active {
            display: block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        th {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .timer {
            font-size: 1.2em;
            color: #e74c3c;
            margin: 20px 0;
        }

        select, input[type="text"] {
            font-size: 1.1em;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #3498db;
            margin: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ma√Ætre de la Conjugaison</h1>
        
        <!-- Menu Principal -->
        <div class="menu-screen active">
            <h2>Choisis ton niveau</h2>
            <button class="btn level" onclick="startGame(1)">Niveau 1<br>Pr√©sent, Futur, Imparfait</button>
            <button class="btn level" onclick="startGame(2)">Niveau 2<br>+ Pass√© simple, Plus-que-parfait, Subjonctif</button>
            <button class="btn level" onclick="startGame(3)">Niveau 3<br>Les 21 temps</button>
            <br><br>
            <label for="timer-select">Timer:</label>
            <select id="timer-select">
                <option value="0">Sans timer</option>
                <option value="5">5 minutes</option>
                <option value="10">10 minutes</option>
                <option value="15">15 minutes</option>
            </select>
            <br><br>
            <input type="text" id="player-name" placeholder="Entrez votre nom" value="Joueur">
        </div>

        <!-- √âcran de jeu -->
        <div class="game-screen">
            <div class="timer" id="timer"></div>
            <div class="score">Score: <span id="score">0</span></div>
            <div class="question" id="question"></div>
            <input type="text" class="answer-input" id="answer" placeholder="Votre r√©ponse">
            <br>
            <button class="btn micro" id="micro-btn" onclick="startRecognition()">üé§</button>
            <br>
            <button class="btn" onclick="checkAnswer()">Valider</button>
            <button class="btn" onclick="showAnswer()">Voir la r√©ponse</button>
            <button class="btn" onclick="showConjugation()">Tableau de conjugaison</button>
            <button class="btn" onclick="backToMenu()">Menu</button>
            <div class="message" id="message"></div>
            <div class="conjugation-table" id="conjugation-table"></div>
        </div>

        <!-- √âcran des scores -->
        <div class="score-screen">
            <h2>Tableau des scores</h2>
            <div id="scoreboard"></div>
            <button class="btn" onclick="backToMenu()">Retour au menu</button>
        </div>
    </div>

    <script>
        // Base de donn√©es des verbes
        const verbs = [
            // 100 verbes les plus communs
            'avoir', '√™tre', 'faire', 'dire', 'aller', 'voir', 'savoir', 'vouloir', 'pouvoir', 'falloir',
            'devoir', 'prendre', 'donner', 'parler', 'aimer', 'mettre', 'venir', 'passer', 'trouver', 'rendre',
            'rester', 'tenir', 'porter', 'para√Ætre', 'mourir', 'para√Ætre', 'sembler', 'vivre', 'entendre', 'sentir',
            'attendre', 'laisser', 'suivre', 'obtenir', 'croire', 'penser', 'comprendre', 'reconna√Ætre', 'souvenir', 'conna√Ætre',
            'regarder', '√©couter', 'r√©pondre', 'demander', 'servir', 'sortir', 'partir', 'arriver', 'entrer', 'monter',
            'descendre', 'tomber', 'na√Ætre', 'devenir', 'revenir', 'appeler', 'lire', '√©crire', 'apprendre', 'enseigner',
            'travailler', 'jouer', 'manger', 'boire', 'dormir', 'courir', 'marcher', 'nager', 'voler', 'rire',
            'pleurer', 'chanter', 'danser', 'vendre', 'acheter', 'payer', 'gagner', 'perdre', 'finir', 'commencer',
            'continuer', 'arr√™ter', 'changer', 'rester', 'devenir', 'revenir', 'partir', 'sortir', 'entrer', 'monter',
            // Plus de verbes...
            'abaisser', 'abandonner', 'abattre', 'abimer', 'aboli', 'abonder', 'abonner', 'aborder', 'aboyer', 'abrutir',
            'absenter', 'absoudre', 'absorber', 'abstenir', 'abuser', 'accepter', 'acclamer', 'accoler', 'accompagner', 'accomplir',
            'accorder', 'accoster', 'accrocher', 'accroitre', 'accueillir', 'accumuler', 'accuser', 'acerer', 'acharner', 'achever',
            'acidifier', 'acoquiner', 'acquerir', 'acquitter', 'actionner', 'activer', 'actualiser', 'adapter', 'additionner', 'adherer',
            'adjuger', 'administrer', 'admirer', 'admettre', 'adolescence', 'adonner', 'adopter', 'adorer', 'adosser', 'adoucir',
            'adresser', 'aerer', 'affaiblir', 'affairer', 'affecter', 'affectionner', 'affermer', 'afficher', 'affirmer', 'affliger',
            'affoler', 'affronter', 'affubler', 'agacer', 'agencer', 'agender', 'aggraver', 'agir', 'agiter', 'agrafer',
            'agrandir', 'agreer', 'agresser', 'aider', 'aigrir', 'aiguiller', 'aiguiser', 'aimanter', 'ajourner', 'ajouter',
            'ajuster', 'alarmer', 'alentir', 'alerter', 'alimenter', 'aligner', 'aliter', 'alleger', 'allier', 'allonger',
            'allumer', 'alourdir', 'alphabetiser', 'alterer', 'alterner', 'alunir', 'amadouer', 'amarrer', 'amasser', 'amateur',
            'amender', 'amener', 'amerrir', 'ameublir', 'amincir', 'amocher', 'amonceler', 'amorcer', 'amortir', 'amplifier',
            'amputer', 'amuser', 'analyser', 'anesthesier', 'angoisser', 'animer', 'annexer', 'annihiler', 'annoncer', 'annoter',
            'annualiser', 'annuler', 'anoblir', 'anticiper', 'apaiser', 'apercevoir', 'apitoyer', 'aplanir', 'applaudir', 'appliquer',
            'apprecier', 'apprehender', 'apprendre', 'approcher', 'approfondir', 'approuver', 'approvisionner', 'arbitrer', 'arc-bouter', 'archiver',
            'armer', 'arraisonner', 'arranger', 'arreter', 'arrimer', 'arriver', 'arroger', 'arrogner', 'arrondir', 'arros er',
            'articuler', 'artificialiser', 'aseptiser', 'asphyxier', 'assembl er', 'assener', 'asservir', 'asseoir', 'assieger', 'assimiler',
            'associer', 'assombrir', 'assommer', 'assortir', 'assouplir', 'assouvir', 'assujettir', 'assumer', 'assurer', 'astiquer',
            'astreindre', 'ateler', 'atermoyer', 'aterrer', 'atterrir', 'attacher', 'attaquer', 'attarder', 'atteindre', 'atteler',
            'attendre', 'attendrir', 'atterrer', 'attester', 'attirer', 'attiser', 'attraper', 'attribuer', 'aubader', 'auditer',
            'augmenter', 'ausculter', 'authentifier', 'autographier', 'auto-imposer', 'automatiser', 'autopsier', 'avaler', 'avancer', 'avenir',
            'averter', 'aveugler', 'avilir', 'aviser', 'aviver', 'avoir', 'avouer', 'avancer', 'aiguilleter', 'abreuver'
        ];

        // Temps de conjugaison
        const tenses = {
            1: ['pr√©sent', 'futur', 'imparfait'],
            2: ['pr√©sent', 'futur', 'imparfait', 'pass√© simple', 'plus-que-parfait', 'subjonctif pr√©sent'],
            3: ['pr√©sent', 'futur', 'imparfait', 'pass√© simple', 'plus-que-parfait', 'subjonctif pr√©sent', 'subjonctif pass√©', 
                'conditionnel pr√©sent', 'conditionnel pass√©', 'imp√©ratif', 'infinitif', 'participe pr√©sent', 'participe pass√©',
                'futur ant√©rieur', 'pass√© compos√©', 'pass√© ant√©rieur', 'subjonctif imparfait', 'subjonctif plus-que-parfait',
                'conditionnel pass√© II', 'imp√©ratif pass√©', 'g√©rondif']
        };

        // Pronoms
        const pronouns = [
            { text: 'premi√®re personne du singulier', pronoun: 'je', alias: ['je', "j'"] },
            { text: 'deuxi√®me personne du singulier', pronoun: 'tu', alias: ['tu'] },
            { text: 'troisi√®me personne du singulier', pronoun: 'il', alias: ['il', 'elle', 'on'] },
            { text: 'premi√®re personne du pluriel', pronoun: 'nous', alias: ['nous'] },
            { text: 'deuxi√®me personne du pluriel', pronoun: 'vous', alias: ['vous'] },
            { text: 'troisi√®me personne du pluriel', pronoun: 'ils', alias: ['ils', 'elles'] }
        ];

        // Variables globales
        let currentLevel = 1;
        let currentScore = 0;
        let currentQuestion = {};
        let recognition = null;
        let timerInterval = null;
        let timeRemaining = 0;

        // Initialisation
        function init() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.lang = 'fr-FR';
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript.toLowerCase().trim();
                    document.getElementById('answer').value = transcript;
                    checkAnswer();
                };
                
                recognition.onerror = function(event) {
                    showMessage('Erreur de reconnaissance vocale', 'error');
                };
            }
        }

        // Commencer le jeu
        function startGame(level) {
            currentLevel = level;
            currentScore = 0;
            document.getElementById('score').textContent = currentScore;
            
            // Timer
            const timerValue = parseInt(document.getElementById('timer-select').value);
            if (timerValue > 0) {
                timeRemaining = timerValue * 60;
                startTimer();
            }
            
            // Sauvegarder le nom du joueur
            const playerName = document.getElementById('player-name').value || 'Joueur';
            localStorage.setItem('playerName', playerName);
            
            // Passer √† l'√©cran de jeu
            document.querySelector('.menu-screen').classList.remove('active');
            document.querySelector('.game-screen').classList.add('active');
            
            // G√©n√©rer la premi√®re question
            generateQuestion();
        }

        // Timer
        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                document.getElementById('timer').textContent = `Temps: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }, 1000);
        }

        // G√©n√©rer une question
        function generateQuestion() {
            const verb = verbs[Math.floor(Math.random() * verbs.length)];
            const tense = tenses[currentLevel][Math.floor(Math.random() * tenses[currentLevel].length)];
            const pronoun = pronouns[Math.floor(Math.random() * pronouns.length)];
            
            currentQuestion = { verb, tense, pronoun };
            
            const questionText = `Conjugue le verbe <span class="verb">${verb}</span> √†<span class="tense">${tense}</span> √† la <span class="pronoun">${pronoun.text}</span> (${pronoun.pronoun})`;
            document.getElementById('question').innerHTML = questionText;
            
            // Vider la r√©ponse pr√©c√©dente
            document.getElementById('answer').value = '';
            document.getElementById('message').innerHTML = '';
            document.getElementById('conjugation-table').classList.remove('active');
            
            // Parler la question
            speak(`Conjugue le verbe ${verb} √† ${tense} √† la ${pronoun.text}`);
        }

        // Reconnaissance vocale
        function startRecognition() {
            if (recognition) {
                recognition.start();
                document.getElementById('micro-btn').style.background = 'linear-gradient(45deg, #e74c3c, #c0392b)';
            } else {
                showMessage('La reconnaissance vocale n\'est pas support√©e', 'error');
            }
        }

        // V√©rifier la r√©ponse
        function checkAnswer() {
            const answer = document.getElementById('answer').value.toLowerCase().trim();
            const correctAnswer = conjugate(currentQuestion.verb, currentQuestion.tense, currentQuestion.pronoun.pronoun);
            
            // V√©rifier les variations avec apostrophes
            let isCorrect = false;
            if (correctAnswer.startsWith("j'")) {
                isCorrect = answer === correctAnswer || answer === correctAnswer.replace("j'", "je ");
            } else {
                isCorrect = answer === correctAnswer;
            }
            
            if (isCorrect) {
                currentScore += 5;
                document.getElementById('score').textContent = currentScore;
                showMessage('Bravo! C\'est super! Formidable!', 'success');
                speak('Bravo!');
                setTimeout(() => generateQuestion(), 2000);
            } else {
                currentScore -= 5;
                document.getElementById('score').textContent = currentScore;
                showMessage('Erreur! Tu peux le faire! Allez continue!', 'error');
                speak('Erreur');
                document.getElementById('answer').value = '';
            }
        }

        // Conjugaison simplifi√©e (exemple avec avoir)
        function conjugate(verb, tense, pronoun) {
            // Pour la d√©mo, je vais utiliser une conjugaison simplifi√©e
            // Dans une vraie application, vous auriez besoin d'une base de donn√©es compl√®te
            const conjugations = {
                'avoir': {
                    'pr√©sent': {
                        'je': "j'ai",
                        'tu': 'as',
                        'il': 'a',
                        'nous': 'avons',
                        'vous': 'avez',
                        'ils': 'ont'
                    },
                    'imparfait': {
                        'je': 'avais',
                        'tu': 'avais',
                        'il': 'avait',
                        'nous': 'avions',
                        'vous': 'aviez',
                        'ils': 'avaient'
                    },
                    'futur': {
                        'je': 'aurai',
                        'tu': 'auras',
                        'il': 'aura',
                        'nous': 'aurons',
                        'vous': 'aurez',
                        'ils': 'auront'
                    }
                },
                '√™tre': {
                    'pr√©sent': {
                        'je': "je suis",
                        'tu': 'es',
                        'il': 'est',
                        'nous': 'sommes',
                        'vous': '√™tes',
                        'ils': 'sont'
                    },
                    'imparfait': {
                        'je': '√©tais',
                        'tu': '√©tais',
                        'il': '√©tait',
                        'nous': '√©tions',
                        'vous': '√©tiez',
                        'ils': '√©taient'
                    },
                    'futur': {
                        'je': 'serai',
                        'tu': 'seras',
                        'il': 'sera',
                        'nous': 'serons',
                        'vous': 'serez',
                        'ils': 'seront'
                    }
                }
            };
            
            // Retourner la conjugaison ou une forme par d√©faut
            if (conjugations[verb] && conjugations[verb][tense] && conjugations[verb][tense][pronoun]) {
                return conjugations[verb][tense][pronoun];
            }
            
            // Forme par d√©faut pour la d√©mo
            return `${pronoun} ${verb}`;
        }

        // Montrer la r√©ponse
        function showAnswer() {
            const answer = conjugate(currentQuestion.verb, currentQuestion.tense, currentQuestion.pronoun.pronoun);
            document.getElementById('answer').value = answer;
            speak(answer);
        }

        // Montrer le tableau de conjugaison
        function showConjugation() {
            const table = document.getElementById('conjugation-table');
            table.classList.toggle('active');
            
            if (table.classList.contains('active')) {
                let html = `<h3>Conjugaison de ${currentQuestion.verb}</h3><table>`;
                html += '<tr><th>Temps</th><th>Je</th><th>Tu</th><th>Il/Elle</th><th>Nous</th><th>Vous</th><th>Ils/Elles</th></tr>';
                
                tenses[currentLevel].forEach(tense => {
                    html += `<tr><td>${tense}</td>`;
                    pronouns.forEach(pronoun => {
                        const conj = conjugate(currentQuestion.verb, tense, pronoun.pronoun);
                        html += `<td>${conj}</td>`;
                    });
                    html += '</tr>';
                });
                
                html += '</table>';
                table.innerHTML = html;
            }
        }

        // Fonction de synth√®se vocale
        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            }
        }

        // Afficher un message
        function showMessage(text, type) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = `message ${type}`;
        }

        // Retour au menu
        function backToMenu() {
            clearInterval(timerInterval);
            document.querySelector('.game-screen').classList.remove('active');
            document.querySelector('.score-screen').classList.remove('active');
            document.querySelector('.menu-screen').classList.add('active');
        }

        // Fin du jeu
        function endGame() {
            const playerName = localStorage.getItem('playerName') || 'Joueur';
            const scores = JSON.parse(localStorage.getItem('scores') || '[]');
            scores.push({ name: playerName, score: currentScore, date: new Date().toLocaleDateString() });
            scores.sort((a, b) => b.score - a.score);
            localStorage.setItem('scores', JSON.stringify(scores));
            
            // Afficher le tableau des scores
            document.querySelector('.game-screen').classList.remove('active');
            document.querySelector('.score-screen').classList.add('active');
            
            let html = '<table><tr><th>Rang</th><th>Nom</th><th>Score</th><th>Date</th></tr>';
            scores.slice(0, 10).forEach((score, index) => {
                html += `<tr><td>${index + 1}</td><td>${score.name}</td><td>${score.score}</td><td>${score.date}</td></tr>`;
            });
            html += '</table>';
            document.getElementById('scoreboard').innerHTML = html;
        }

        // Initialiser l'application
        init();
    </script>
</body>
</html>
