<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma√Ætre de la Conjugaison</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* √âcran d'accueil */
        .home-screen {
            text-align: center;
            padding: 50px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            backdrop-filter: blur(10px);
            margin: 20px;
        }

        .title {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 3s ease infinite;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .subtitle {
            font-size: 1.2rem;
            color: white;
            margin-bottom: 40px;
            font-weight: 300;
        }

        .level-selection {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .level-btn:nth-child(1) { background: linear-gradient(135deg, #667eea, #764ba2); }
        .level-btn:nth-child(2) { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .level-btn:nth-child(3) { background: linear-gradient(135deg, #4facfe, #00f2fe); }

        .level-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .timer-selection {
            margin-top: 20px;
        }

        .timer-btn {
            padding: 10px 20px;
            margin: 5px;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timer-btn:hover, .timer-btn.active {
            background: white;
            color: #667eea;
        }

        .start-btn {
            padding: 20px 50px;
            font-size: 1.3rem;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 30px;
            font-weight: 600;
            box-shadow: 0 6px 20px rgba(238, 90, 36, 0.4);
        }

        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(238, 90, 36, 0.6);
        }

        /* √âcran de jeu */
        .game-screen {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .score-display {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .timer-display {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 15px 25px;
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .question-section {
            text-align: center;
            margin: 40px 0;
        }

        .question-text {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #333;
            line-height: 1.6;
        }

        .verb-word { color: #ff6b6b; font-weight: 600; }
        .tense-word { color: #48dbfb; font-weight: 600; }
        .pronoun-word { color: #feca57; font-weight: 600; }

        .answer-input {
            width: 100%;
            max-width: 400px;
            padding: 15px 20px;
            font-size: 1.2rem;
            border: 3px solid #e0e0e0;
            border-radius: 25px;
            text-align: center;
            transition: all 0.3s ease;
            margin: 20px auto;
            display: block;
        }

        .answer-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .microphone-container {
            text-align: center;
            margin: 30px 0;
        }

        .microphone-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .microphone-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }

        .microphone-btn.recording {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .show-answer-btn { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .show-table-btn { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .next-btn { background: linear-gradient(135deg, #43e97b, #38f9d7); }
        .restart-btn { background: linear-gradient(135deg, #fa709a, #fee140); }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .feedback-message {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
            margin: 20px 0;
            padding: 15px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .success {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
        }

        .error {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .conjugation-table {
            display: none;
            margin: 30px 0;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .table-title {
            text-align: center;
            font-size: 1.3rem;
            color: #667eea;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .conjugation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .tense-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
        }

        .tense-name {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }

        .conjugation-item {
            margin: 5px 0;
            font-size: 0.9rem;
        }

        .score-table {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            z-index: 1000;
            max-width: 500px;
            width: 90%;
        }

        .score-table h2 {
            text-align: center;
            color: #667eea;
            margin-bottom: 20px;
        }

        .score-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .name-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        @media (max-width: 768px) {
            .title { font-size: 2.5rem; }
            .level-selection { flex-direction: column; align-items: center; }
            .game-header { flex-direction: column; text-align: center; }
            .question-text { font-size: 1.2rem; }
            .conjugation-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- √âcran d'accueil -->
        <div class="home-screen" id="homeScreen">
            <h1 class="title">Ma√Ætre de la Conjugaison</h1>
            <p class="subtitle">Devenez un expert en conjugaison fran√ßaise</p>
            
            <div class="level-selection">
                <button class="level-btn" onclick="selectLevel(1)">
                    Niveau 1<br>
                    <small>Pr√©sent, Futur, Imparfait</small>
                </button>
                <button class="level-btn" onclick="selectLevel(2)">
                    Niveau 2<br>
                    <small>+ Pass√© simple, Plus-que-parfait, Subjonctif</small>
                </button>
                <button class="level-btn" onclick="selectLevel(3)">
                    Niveau 3<br>
                    <small>Les 21 temps</small>
                </button>
            </div>

            <div class="timer-selection">
                <p style="color: white; margin-bottom: 10px;">Choisir un temps limite :</p>
                <button class="timer-btn" onclick="selectTimer(5)">5 min</button>
                <button class="timer-btn" onclick="selectTimer(10)">10 min</button>
                <button class="timer-btn" onclick="selectTimer(15)">15 min</button>
                <button class="timer-btn active" onclick="selectTimer(0)">Sans limite</button>
            </div>

            <button class="start-btn" onclick="startGame()">Commencer</button>
        </div>

        <!-- √âcran de jeu -->
        <div class="game-screen" id="gameScreen">
            <div class="game-header">
                <div class="score-display">Score: <span id="score">0</span></div>
                <div class="timer-display" id="timerDisplay">Temps: <span id="timer">--</span></div>
            </div>

            <div class="question-section">
                <div class="question-text" id="questionText"></div>
                <input type="text" class="answer-input" id="answerInput" placeholder="Votre r√©ponse">
            </div>

            <div class="microphone-container">
                <button class="microphone-btn" id="microphoneBtn" onclick="toggleMicrophone()">
                    üé§
                </button>
                <p style="margin-top: 10px; color: #666;">Cliquez pour r√©pondre √† voix haute</p>
            </div>

            <div class="feedback-message" id="feedbackMessage"></div>

            <div class="action-buttons">
                <button class="action-btn show-answer-btn" onclick="showAnswer()">Montrer la r√©ponse</button>
                <button class="action-btn show-table-btn" onclick="showConjugationTable()">Voir la conjugaison</button>
                <button class="action-btn restart-btn" onclick="restartGame()">Recommencer</button>
            </div>

            <div class="conjugation-table" id="conjugationTable">
                <div class="table-title">Conjugaison compl√®te du verbe</div>
                <div class="conjugation-grid" id="conjugationGrid"></div>
            </div>
        </div>

        <!-- Tableau des scores -->
        <div class="overlay" id="overlay"></div>
        <div class="score-table" id="scoreTable">
            <button class="close-btn" onclick="closeScoreTable()">√ó</button>
            <h2>Tableau des scores</h2>
            <input type="text" class="name-input" id="playerName" placeholder="Entrez votre nom">
            <button class="action-btn" onclick="saveScore()">Sauvegarder</button>
            <div class="score-list" id="scoreList"></div>
        </div>
    </div>

    <script>
        // Base de donn√©es de verbes avec conjugaison
        const verbes = [
            // 100 verbes les plus courants
            {
                infinitif: "avoir",
                participes: { present: "ayant", passe: "eu" },
                present: ["ai", "as", "a", "avons", "avez", "ont"],
                imparfait: ["avais", "avais", "avait", "avions", "aviez", "avaient"],
                futur: ["aurai", "auras", "aura", "aurons", "aurez", "auront"],
                passe_simple: ["eus", "eus", "eut", "e√ªmes", "e√ªtes", "eurent"],
                plus_que_parfait: ["avais eu", "avais eu", "avait eu", "avions eu", "aviez eu", "avaient eu"],
                passe_compose: ["ai eu", "as eu", "a eu", "avons eu", "avez eu", "ont eu"],
                subjonctif_present: ["aie", "aies", "ait", "ayons", "ayez", "aient"],
                subjonctif_passe: ["aie eu", "aies eu", "ait eu", "ayons eu", "ayez eu", "aient eu"],
                conditionnel: ["aurais", "aurais", "aurait", "aurions", "auriez", "auraient"],
                imperatif: ["aie", "ayons", "ayez"]
            },
            {
                infinitif: "√™tre",
                participes: { present: "√©tant", passe: "√©t√©" },
                present: ["suis", "es", "est", "sommes", "√™tes", "sont"],
                imparfait: ["√©tais", "√©tais", "√©tait", "√©tions", "√©tiez", "√©taient"],
                futur: ["serai", "seras", "sera", "serons", "serez", "seront"],
                passe_simple: ["fus", "fus", "fut", "f√ªmes", "f√ªtes", "furent"],
                plus_que_parfait: ["avais √©t√©", "avais √©t√©", "avait √©t√©", "avions √©t√©", "aviez √©t√©", "avaient √©t√©"],
                passe_compose: ["ai √©t√©", "as √©t√©", "a √©t√©", "avons √©t√©", "avez √©t√©", "ont √©t√©"],
                subjonctif_present: ["sois", "sois", "soit", "soyons", "soyez", "soient"],
                subjonctif_passe: ["aie √©t√©", "aies √©t√©", "ait √©t√©", "ayons √©t√©", "ayez √©t√©", "aient √©t√©"],
                conditionnel: ["serais", "serais", "serait", "serions", "seriez", "seraient"],
                imperatif: ["sois", "soyons", "soyez"]
            },
            {
                infinitif: "aller",
                participes: { present: "allant", passe: "all√©" },
                present: ["vais", "vas", "va", "allons", "allez", "vont"],
                imparfait: ["allais", "allais", "allait", "allions", "alliez", "allaient"],
                futur: ["irai", "iras", "ira", "irons", "irez", "iront"],
                passe_simple: ["allai", "allas", "alla", "all√¢mes", "all√¢tes", "all√®rent"],
                plus_que_parfait: ["avais all√©", "avais all√©", "avait all√©", "avions all√©", "aviez all√©", "avaient all√©"],
                passe_compose: ["suis all√©", "es all√©", "est all√©", "sommes all√©s", "√™tes all√©s", "sont all√©s"],
                subjonctif_present: ["aille", "ailles", "aille", "allions", "alliez", "aillent"],
                subjonctif_passe: ["sois all√©", "sois all√©", "soit all√©", "soyons all√©s", "soyez all√©s", "soient all√©s"],
                conditionnel: ["irais", "irais", "irait", "irions", "iriez", "iraient"],
                imperatif: ["va", "allons", "allez"]
            },
            // Ajouter plus de verbes ici...
        ];

        // Variables globales
        let currentLevel = 1;
        let selectedTimer = 0;
        let score = 0;
        let currentQuestion = null;
        let timerInterval = null;
        let recognition = null;
        let isRecording = false;
        let playerName = localStorage.getItem('playerName') || '';

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initializeSpeechRecognition();
            loadScores();
        });

        // Fonctions de jeu
        function selectLevel(level) {
            currentLevel = level;
            document.querySelectorAll('.level-btn').forEach(btn => btn.style.opacity = '0.7');
            document.querySelectorAll('.level-btn')[level-1].style.opacity = '1';
        }

        function selectTimer(minutes) {
            selectedTimer = minutes;
            document.querySelectorAll('.timer-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function startGame() {
            document.getElementById('homeScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            if (selectedTimer > 0) {
                startTimer(selectedTimer * 60);
            }
            
            generateQuestion();
            speakQuestion();
        }

        function generateQuestion() {
            const verbe = verbes[Math.floor(Math.random() * verbes.length)];
            const temps = getRandomTense();
            const personne = Math.floor(Math.random() * 6);
            const pronoms = ['je', 'tu', 'il/elle', 'nous', 'vous', 'ils/elles'];
            
            currentQuestion = {
                verbe: verbe,
                temps: temps,
                personne: personne,
                pronom: pronoms[personne],
                reponse: verbe[temps][personne]
            };

            displayQuestion();
        }

        function getRandomTense() {
            const tensesByLevel = {
                1: ['present', 'futur', 'imparfait'],
                2: ['present', 'futur', 'imparfait', 'passe_simple', 'plus_que_parfait', 'subjonctif_present'],
                3: ['present', 'futur', 'imparfait', 'passe_simple', 'plus_que_parfait', 'subjonctif_present', 
                    'subjonctif_passe', 'conditionnel', 'passe_compose', 'imperatif']
            };
            
            const availableTenses = tensesByLevel[currentLevel];
            return availableTenses[Math.floor(Math.random() * availableTenses.length)];
        }

        function displayQuestion() {
            const questionText = `Conjugue le verbe <span class="verb-word">${currentQuestion.verbe.infinitif}</span> 
                                 <span class="tense-word">${getTenseName(currentQuestion.temps)}</span> 
                                 √† la <span class="pronoun-word">${getPronounName(currentQuestion.personne)}</span> (${currentQuestion.pronom})`;
            
            document.getElementById('questionText').innerHTML = questionText;
            document.getElementById('answerInput').value = '';
            document.getElementById('feedbackMessage').innerHTML = '';
            document.getElementById('conjugationTable').style.display = 'none';
        }

        function getTenseName(tense) {
            const tenseNames = {
                'present': 'au pr√©sent',
                'imparfait': '√† l\'imparfait',
                'futur': 'au futur',
                'passe_simple': 'au pass√© simple',
                'plus_que_parfait': 'au plus-que-parfait',
                'passe_compose': 'au pass√© compos√©',
                'subjonctif_present': 'au subjonctif pr√©sent',
                'subjonctif_passe': 'au subjonctif pass√©',
                'conditionnel': 'au conditionnel',
                'imperatif': '√† l\'imp√©ratif'
            };
            return tenseNames[tense] || tense;
        }

        function getPronounName(person) {
            const pronounNames = [
                'premi√®re personne du singulier',
                'deuxi√®me personne du singulier',
                'troisi√®me personne du singulier',
                'premi√®re personne du pluriel',
                'deuxi√®me personne du pluriel',
                'troisi√®me personne du pluriel'
            ];
            return pronounNames[person];
        }

        function checkAnswer() {
            const userAnswer = document.getElementById('answerInput').value.trim().toLowerCase();
            const correctAnswer = currentQuestion.reponse.toLowerCase();
            
            if (userAnswer === correctAnswer) {
                handleCorrectAnswer();
            } else {
                handleIncorrectAnswer();
            }
        }

        function handleCorrectAnswer() {
            score += 5;
            document.getElementById('score').textContent = score;
            
            const messages = ['Bravo !', 'C\'est super !', 'Formidable !', 'C\'est g√©nial !'];
            const message = messages[Math.floor(Math.random() * messages.length)];
            
            showFeedback(message, 'success');
            speak(message);
            
            setTimeout(() => {
                generateQuestion();
                speakQuestion();
            }, 2000);
        }

        function handleIncorrectAnswer() {
            score -= 5;
            document.getElementById('score').textContent = score;
            
            speak('Erreur');
            
            const messages = ['Tu peux le faire !', 'Allez, continue !', 'R√©fl√©chis bien !'];
            const message = messages[Math.floor(Math.random() * messages.length)];
            
            showFeedback(message, 'error');
            document.getElementById('answerInput').value = '';
            
            setTimeout(() => {
                document.getElementById('feedbackMessage').innerHTML = '';
            }, 3000);
        }

        function showFeedback(message, type) {
            const feedbackElement = document.getElementById('feedbackMessage');
            feedbackElement.textContent = message;
            feedbackElement.className = `feedback-message ${type}`;
        }

        function showAnswer() {
            if (currentQuestion) {
                const answer = `${currentQuestion.pronom} ${currentQuestion.reponse}`;
                document.getElementById('answerInput').value = answer;
                speak(answer);
            }
        }

        function showConjugationTable() {
            if (currentQuestion) {
                const table = document.getElementById('conjugationTable');
                const grid = document.getElementById('conjugationGrid');
                
                grid.innerHTML = '';
                
                const tenses = ['present', 'imparfait', 'futur', 'passe_simple', 'plus_que_parfait', 
                              'subjonctif_present', 'conditionnel', 'passe_compose'];
                
                tenses.forEach(tense => {
                    if (currentQuestion.verbe[tense]) {
                        const group = document.createElement('div');
                        group.className = 'tense-group';
                        
                        const title = document.createElement('div');
                        title.className = 'tense-name';
                        title.textContent = getTenseName(tense);
                        group.appendChild(title);
                        
                        const pronouns = ['je', 'tu', 'il/elle', 'nous', 'vous', 'ils/elles'];
                        currentQuestion.verbe[tense].forEach((form, index) => {
                            const item = document.createElement('div');
                            item.className = 'conjugation-item';
                            item.innerHTML = `<strong>${pronouns[index]}:</strong> ${form}`;
                            group.appendChild(item);
                        });
                        
                        grid.appendChild(group);
                    }
                });
                
                table.style.display = 'block';
            }
        }

        function restartGame() {
            score = 0;
            document.getElementById('score').textContent = score;
            generateQuestion();
            speakQuestion();
        }

        function startTimer(seconds) {
            let timeLeft = seconds;
            
            timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                document.getElementById('timer').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endGame();
                }
                
                timeLeft--;
            }, 1000);
        }

        function endGame() {
            speak('Le temps est √©coul√© !');
            showScoreTable();
        }

        // Reconnaissance vocale
        function initializeSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.lang = 'fr-FR';
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript.trim();
                    document.getElementById('answerInput').value = transcript;
                    checkAnswer();
                };
                
                recognition.onerror = function(event) {
                    console.error('Erreur de reconnaissance vocale:', event.error);
                    stopRecording();
                };
                
                recognition.onend = function() {
                    stopRecording();
                };
            }
        }

        function toggleMicrophone() {
            if (!recognition) {
                alert('La reconnaissance vocale n\'est pas support√©e par votre navigateur.');
                return;
            }
            
            if (isRecording) {
                recognition.stop();
            } else {
                recognition.start();
                startRecording();
            }
        }

        function startRecording() {
            isRecording = true;
            document.getElementById('microphoneBtn').classList.add('recording');
        }

        function stopRecording() {
            isRecording = false;
            document.getElementById('microphoneBtn').classList.remove('recording');
        }

        // Synth√®se vocale
        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                speechSynthesis.speak(utterance);
            }
        }

        function speakQuestion() {
            setTimeout(() => {
                const questionText = document.getElementById('questionText').textContent;
                speak(questionText);
            }, 500);
        }

        // Gestion des scores
        function showScoreTable() {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('scoreTable').style.display = 'block';
            loadScores();
        }

        function closeScoreTable() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('scoreTable').style.display = 'none';
        }

        function saveScore() {
            const name = document.getElementById('playerName').value.trim();
            if (name) {
                playerName = name;
                localStorage.setItem('playerName', name);
                
                let scores = JSON.parse(localStorage.getItem('conjugationScores') || '[]');
                scores.push({
                    name: name,
                    score: score,
                    date: new Date().toLocaleDateString('fr-FR'),
                    level: currentLevel
                });
                
                scores.sort((a, b) => b.score - a.score);
                scores = scores.slice(0, 10); // Garder les 10 meilleurs
                
                localStorage.setItem('conjugationScores', JSON.stringify(scores));
                loadScores();
            }
        }

        function loadScores() {
            const scores = JSON.parse(localStorage.getItem('conjugationScores') || '[]');
            const scoreList = document.getElementById('scoreList');
            
            scoreList.innerHTML = '';
            scores.forEach((score, index) => {
                const item = document.createElement('div');
                item.className = 'score-item';
                item.innerHTML = `
                    <span>${index + 1}. ${score.name}</span>
                    <span>${score.score} pts (Niv. ${score.level})</span>
                `;
                scoreList.appendChild(item);
            });
            
            if (playerName) {
                document.getElementById('playerName').value = playerName;
            }
        }

        // √âcouteurs d'√©v√©nements
        document.getElementById('answerInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Fermer le tableau des scores en cliquant sur l'overlay
        document.getElementById('overlay').addEventListener('click', closeScoreTable);
    </script>
</body>
</html>
