<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma√Ætre de la Conjugaison</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 90%;
        }

        h1 {
            text-align: center;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .menu {
            text-align: center;
            display: none;
        }

        .menu.active {
            display: block;
        }

        .level-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-level-1 {
            background: linear-gradient(45deg, #56ab2f, #a8e6cf);
            color: white;
        }

        .btn-level-2 {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .btn-level-3 {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-micro {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 2em;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
        }

        .btn-micro.recording {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7);
            }
            70% {
                box-shadow: 0 0 0 20px rgba(255, 107, 107, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 107, 107, 0);
            }
        }

        .question {
            font-size: 1.3em;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            text-align: center;
        }

        .verb { color: #e74c3c; font-weight: bold; }
        .tense { color: #3498db; font-weight: bold; }
        .pronoun { color: #9b59b6; font-weight: bold; }

        .answer-section {
            margin: 20px 0;
            text-align: center;
        }

        .answer-input {
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 10px;
            width: 300px;
            max-width: 100%;
            text-align: center;
        }

        .score {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: #27ae60;
        }

        .message {
            text-align: center;
            font-size: 1.2em;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
        }

        .success {
            background: linear-gradient(45deg, #56ab2f, #a8e6cf);
            color: white;
        }

        .error {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .timer {
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
        }

        .conjugation-table {
            display: none;
            margin: 20px 0;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .conjugation-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .conjugation-table th,
        .conjugation-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .conjugation-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .player-name {
            padding: 10px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 10px 0;
            width: 100%;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ma√Ætre de la Conjugaison</h1>
        
        <div id="mainMenu" class="menu active">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalScore">0</div>
                    <div class="stat-label">Score Total</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalQuestions">0</div>
                    <div class="stat-label">Questions R√©pondues</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="verbsCount">1000</div>
                    <div class="stat-label">Verbes Disponibles</div>
                </div>
            </div>
            
            <h2>Choisis ton niveau de difficult√©</h2>
            <div class="level-buttons">
                <button class="btn btn-level-1" onclick="startGame(1)">Niveau 1<br>Pr√©sent, Futur, Imparfait</button>
                <button class="btn btn-level-2" onclick="startGame(2)">Niveau 2<br>+ Pass√© simple, Plus-que-parfait, Subjonctif</button>
                <button class="btn btn-level-3" onclick="startGame(3)">Niveau 3<br>Les 21 temps</button>
            </div>
            
            <div style="margin-top: 30px;">
                <label for="timerSelect">Dur√©e du jeu :</label>
                <select id="timerSelect" class="player-name" style="width: 200px;">
                    <option value="0">Sans limite</option>
                    <option value="5">5 minutes</option>
                    <option value="10">10 minutes</option>
                    <option value="15">15 minutes</option>
                </select>
            </div>
            
            <button class="btn" style="background: linear-gradient(45deg, #3498db, #2980b9); color: white; margin-top: 20px;" onclick="showScores()">Tableau des Scores</button>
        </div>

        <div id="gameScreen" class="menu">
            <div class="timer" id="timer"></div>
            <div class="score">Score : <span id="currentScore">0</span></div>
            
            <div class="question" id="question">
                <span class="verb">Verbe</span> au <span class="tense">temps</span> √† la <span class="pronoun">personne</span>
            </div>
            
            <div class="answer-section">
                <input type="text" id="answerInput" class="answer-input" placeholder="Ta r√©ponse">
                <button class="btn btn-micro" id="microBtn" onclick="startRecording()">üé§</button>
            </div>
            
            <div id="message" class="message" style="display: none;"></div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" style="background: linear-gradient(45deg, #f39c12, #e67e22); color: white;" onclick="showAnswer()">Montrer la r√©ponse</button>
                <button class="btn" style="background: linear-gradient(45deg, #27ae60, #2ecc71); color: white;" onclick="showConjugation()">Tableau de conjugaison</button>
                <button class="btn" style="background: linear-gradient(45deg, #e74c3c, #c0392b); color: white;" onclick="backToMenu()">Retour au menu</button>
            </div>
            
            <div id="conjugationTable" class="conjugation-table">
                <h3>Conjugaison compl√®te</h3>
                <table id="conjugationContent"></table>
            </div>
        </div>

        <div id="scoresModal" class="modal">
            <div class="modal-content">
                <h2>Tableau des Scores</h2>
                <div id="scoresList"></div>
                <button class="btn" style="background: linear-gradient(45deg, #3498db, #2980b9); color: white; margin-top: 20px;" onclick="closeScores()">Fermer</button>
            </div>
        </div>
    </div>

    <script>
        // Base de donn√©es des verbes
        const verbs = [
            // 1000 verbes fran√ßais (simplifi√© pour la d√©mo - en r√©alit√© il faudrait tous les conjuguer)
            "avoir", "√™tre", "faire", "aller", "prendre", "voir", "venir", "savoir", "vouloir", "pouvoir",
            "dire", "devoir", "donner", "parler", "aimer", "mettre", "passer", "trouver", "laisser", "penser",
            "sembler", "mener", "para√Ætre", "tenir", "para√Ætre", "devenir", "tomber", "entrer", "sortir", "partir",
            "arriver", "rester", "vivre", "mourir", "na√Ætre", "cro√Ætre", "accro√Ætre", "d√©cro√Ætre", "conna√Ætre", "para√Ætre",
            "reconna√Ætre", "m√©conna√Ætre", "para√Ætre", "appara√Ætre", "dispara√Ætre", "compara√Ætre", "repara√Ætre", "transpara√Ætre", "√©crire", "d√©crire",
            "prescrire", "inscrire", "souscrire", "proscrire", "circumscrire", "confiner", "d√©finir", "satisfaire", "magnifier", "pacifier",
            "ramifier", "intensifier", "diversifier", "fortifier", "justifier", "amplifier", "simplifier", "rectifier", "modifier", "clarifier",
            "purifier", "glorifier", "horrifier", "terrifier", "√©lectrifier", "calcifier", "gasifier", "liqu√©fier", "solidifier", "petrifier",
            "stup√©fier", "toxifier", "verdifier", "jaunifier", "rougifier", "noircir", "blanchir", "verdir", "jaunir", "rougir",
            "bleuir", "grisir", "brunir", "amincir", "engraisser", "ralentir", "acc√©l√©rer", "diminuer", "augmenter", "allonger",
            "raccourcir", "√©largir", "r√©tr√©cir", "approfondir", "sur√©lever", "abaisser", "d√©placer", "immobiliser", "lib√©rer", "emprisonner",
            "encha√Æner", "d√©tacher", "lier", "s√©parer", "unir", "diviser", "multiplier", "additionner", "soustraire", "extraire",
            "introduire", "produire", "conduire", "r√©duire", "augmenter", "diminuer", "accro√Ætre", "d√©cro√Ætre", "progresser", "r√©gresser",
            "avancer", "reculer", "monter", "descendre", "grimper", "glisser", "voler", "nager", "marcher", "courir",
            "sauter", "danser", "chanter", "jouer", "dessiner", "peindre", "sculpter", "modeler", "tailler", "scier",
            "marteler", "forger", "fonder", "mouler", "couler", "durcir", "ramollir", "fondre", "geler", "bouillir",
            "cuire", "griller", "frire", "r√¥tir", "p√©trir", "m√©langer", "remuer", "agiter", "secouer", "balancer",
            "osciller", "vibrer", "trembler", "frissonner", "suer", "transpirer", "respirer", "souffler", "haleter", "tousser",
            "ternir", "briller", "luire", "scintiller", "√©tinceler", "fulgurer", "√©clairer", "illuminer", "obscurcir", "assombrir",
            "√©blouir", "aveugler", "apercevoir", "distinguer", "discerner", "remarquer", "observer", "regarder", "contempler", "surveiller",
            "√©pier", "guetter", "d√©visager", "fixer", "d√©tourner", "incliner", "pencher", "tourner", "pivoter", "rouler",
            "tirer", "pousser", "soulever", "abaisser", "porter", "transporter", "d√©placer", "remuer", "secouer", "agiter",
            "frapper", "battre", "tape", "gifler", "cogner", "heurter", "percuter", "choquer", "collisionner", "rencontrer",
            "aborder", "accoster", "atterrir", "amerrir", "√©chouer", "naufrager", "sombrer", "couler", "flotter", "nager",
            "plonger", "√©merger", "appara√Ætre", "dispara√Ætre", "surgir", "jaillir", "gicler", "sprinter", "filer", "d√©valer",
            "gravir", "escalader", "franchir", "tr√©bucher", "chuter", "s'effondrer", "s'√©crouler", "s'effondrer", "d√©molir", "d√©truire",
            "ruiner", "endommager", "ab√Æmer", "d√©t√©riorer", "d√©grader", "alt√©rer", "corrompre", "contaminer", "polluer", "infecter",
            "purifier", "nettoyer", "laver", "rincer", "essuyer", "s√©cher", "essorer", "essorer", "tordre", "plier",
            "d√©plier", "√©tendre", "tendre", "d√©tendre", "rel√¢cher", "l√¢cher", "prisonnier", "captiver", "capturer", "attraper",
            "saisir", "prendre", "empoigner", "agripper", "serrer", "√©treindre", "embrasser", "caresser", "toucher", "fr√¥ler",
            "effleurer", "palper", "t√¢ter", "sonder", "explorer", "fouiller", "chercher", "trouver", "d√©couvrir", "inventer",
            "cr√©er", "fabriquer", "construire", "√©difier", "b√¢tir", "√©riger", "installer", "disposer", "arranger", "organiser",
            "ranger", "ordonner", "r√©gler", "ajuster", "adapter", "accommoder", "am√©nager", "transformer", "convertir", "m√©tamorphoser",
            "changer", "modifier", "alt√©rer", "remplacer", "substituer", "√©changer", "intervertir", "renverser", "inverser", "retourner",
            "renverser", "basculer", "culbuter", "rebrousser", "retourner", "revoir", "revenir", "retourner", "rentrer", "rester",
            "demeurer", "habiter", "loger", "s√©journer", "visiter", "parcourir", "voyager", "circuler", "d√©filer", "d√©ambuler",
            "errer", "roder", "tra√Æner", "fl√¢ner", "se promener", "balader", "explorer", "d√©couvrir", "trouver", "d√©goter",
            "d√©nicher", "d√©terrer", "excavateur", "fouiller", "creuser", "enfouir", "enterrer", "ensevelir", "inhumer", "c√©l√©brer",
            "f√™ter", "organiser", "pr√©parer", "planifier", "programmer", "√©tablir", "instaurer", "instituer", "cr√©er", "fonder",
            "√©tablir", "installer", "implanter", "introduire", "ins√©rer", "int√©grer", "incorporer", "inclure", "contenir", "renfermer",
            "emprisonner", "enfermer", "cl√¥turer", "encercler", "entourer", "encercler", "encercler", "encercler", "encercler", "encercler"
        ];

        // Temps de conjugaison
        const tenses = {
            1: ['pr√©sent', 'futur', 'imparfait'],
            2: ['pr√©sent', 'futur', 'imparfait', 'pass√© simple', 'plus-que-parfait', 'subjonctif pr√©sent'],
            3: ['pr√©sent', 'futur', 'imparfait', 'pass√© simple', 'plus-que-parfait', 'subjonctif pr√©sent', 'subjonctif pass√©', 'conditionnel pr√©sent', 'conditionnel pass√©', 'imp√©ratif', 'infinitif', 'participe pr√©sent', 'participe pass√©', 'futur ant√©rieur', 'pass√© compos√©', 'pass√© ant√©rieur']
        };

        // Pronoms
        const pronouns = [
            { text: 'premi√®re personne du singulier', pronoun: 'je', abbreviation: 'je' },
            { text: 'deuxi√®me personne du singulier', pronoun: 'tu', abbreviation: 'tu' },
            { text: 'troisi√®me personne du singulier', pronoun: 'il/elle', abbreviation: 'il' },
            { text: 'premi√®re personne du pluriel', pronoun: 'nous', abbreviation: 'nous' },
            { text: 'deuxi√®me personne du pluriel', pronoun: 'vous', abbreviation: 'vous' },
            { text: 'troisi√®me personne du pluriel', pronoun: 'ils/elles', abbreviation: 'ils' }
        ];

        // Variables globales
        let currentLevel = 1;
        let currentScore = 0;
        let currentQuestion = null;
        let timerInterval = null;
        let timeRemaining = 0;
        let recognition = null;
        let currentVerb = '';
        let playerName = '';

        // Initialisation
        window.onload = function() {
            loadPlayerData();
            initializeSpeechRecognition();
        };

        // Initialisation de la reconnaissance vocale
        function initializeSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.lang = 'fr-FR';
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript.toLowerCase().trim();
                    document.getElementById('answerInput').value = transcript;
                    checkAnswer();
                };
                
                recognition.onerror = function(event) {
                    console.error('Erreur de reconnaissance vocale:', event.error);
                    document.getElementById('microBtn').classList.remove('recording');
                };
                
                recognition.onend = function() {
                    document.getElementById('microBtn').classList.remove('recording');
                };
            }
        }

        // D√©marrer l'enregistrement vocal
        function startRecording() {
            if (recognition && !document.getElementById('microBtn').classList.contains('recording')) {
                try {
                    recognition.start();
                    document.getElementById('microBtn').classList.add('recording');
                } catch (error) {
                    console.error('Erreur lors du d√©marrage de la reconnaissance:', error);
                }
            }
        }

        // Charger les donn√©es du joueur
        function loadPlayerData() {
            const savedData = localStorage.getItem('conjugationMasterData');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('totalScore').textContent = data.totalScore || 0;
                document.getElementById('totalQuestions').textContent = data.totalQuestions || 0;
                playerName = data.playerName || '';
            }
        }

        // Sauvegarder les donn√©es du joueur
        function savePlayerData() {
            const data = {
                playerName: playerName,
                totalScore: parseInt(document.getElementById('totalScore').textContent),
                totalQuestions: parseInt(document.getElementById('totalQuestions').textContent),
                lastPlayed: new Date().toISOString()
            };
            localStorage.setItem('conjugationMasterData', JSON.stringify(data));
        }

        // D√©marrer le jeu
        function startGame(level) {
            currentLevel = level;
            currentScore = 0;
            document.getElementById('currentScore').textContent = '0';
            
            // Configuration du timer
            const timerValue = parseInt(document.getElementById('timerSelect').value);
            if (timerValue > 0) {
                timeRemaining = timerValue * 60;
                startTimer();
            }
            
            // Afficher l'√©cran de jeu
            document.getElementById('mainMenu').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            
            // G√©n√©rer la premi√®re question
            generateQuestion();
        }

        // D√©marrer le timer
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(function() {
                timeRemaining--;
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                document.getElementById('timer').textContent = `Temps restant : ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }, 1000);
        }

        // G√©n√©rer une question
        function generateQuestion() {
            const verb = verbs[Math.floor(Math.random() * verbs.length)];
            const tense = tenses[currentLevel][Math.floor(Math.random() * tenses[currentLevel].length)];
            const pronoun = pronouns[Math.floor(Math.random() * pronouns.length)];
            
            currentQuestion = {
                verb: verb,
                tense: tense,
                pronoun: pronoun,
                answer: getConjugation(verb, tense, pronoun.abbreviation)
            };
            
            // Afficher la question
            document.getElementById('question').innerHTML = 
                `Conjugue le verbe <span class="verb">${verb}</span> au <span class="tense">${tense}</span> √† la <span class="pronoun">${pronoun.text} (${pronoun.pronoun})</span>`;
            
            // Vider le champ de r√©ponse
            document.getElementById('answerInput').value = '';
            document.getElementById('answerInput').focus();
            
            // Cacher les messages et tableaux
            document.getElementById('message').style.display = 'none';
            document.getElementById('conjugationTable').style.display = 'none';
            
            // Parler la question
            speakQuestion();
        }

        // Obtenir la conjugaison (simplifi√© pour la d√©mo)
        function getConjugation(verb, tense, pronoun) {
            // Cette fonction devrait contenir toutes les conjugaisons
            // Pour la d√©mo, on retourne une forme simplifi√©e
            const conjugations = {
                'avoir': {
                    'pr√©sent': { 'je': 'ai', 'tu': 'as', 'il': 'a', 'nous': 'avons', 'vous': 'avez', 'ils': 'ont' },
                    'imparfait': { 'je': 'avais', 'tu': 'avais', 'il': 'avait', 'nous': 'avions', 'vous': 'aviez', 'ils': 'avaient' },
                    'futur': { 'je': 'aurai', 'tu': 'auras', 'il': 'aura', 'nous': 'aurons', 'vous': 'aurez', 'ils': 'auront' }
                },
                '√™tre': {
                    'pr√©sent': { 'je': 'suis', 'tu': 'es', 'il': 'est', 'nous': 'sommes', 'vous': '√™tes', 'ils': 'sont' },
                    'imparfait': { 'je': '√©tais', 'tu': '√©tais', 'il': '√©tait', 'nous': '√©tions', 'vous': '√©tiez', 'ils': '√©taient' },
                    'futur': { 'je': 'serai', 'tu': 'seras', 'il': 'sera', 'nous': 'serons', 'vous': 'serez', 'ils': 'seront' }
                }
            };
            
            if (conjugations[verb] && conjugations[verb][tense] && conjugations[verb][tense][pronoun]) {
                return conjugations[verb][tense][pronoun];
            }
            
            // Pour les verbes non d√©finis, retourner une forme par d√©faut
            return `${pronoun}_${verb}_${tense}`;
        }

        // Parler la question
        function speakQuestion() {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(
                    `Conjugue le verbe ${currentQuestion.verb} au ${currentQuestion.tense} √† la ${currentQuestion.pronoun.text}`
                );
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                speechSynthesis.speak(utterance);
            }
        }

        // V√©rifier la r√©ponse
        function checkAnswer() {
            const userAnswer = document.getElementById('answerInput').value.toLowerCase().trim();
            const correctAnswer = currentQuestion.answer.toLowerCase();
            
            // G√©rer les apostrophes et espaces
            const normalizedUserAnswer = userAnswer.replace(/'/g, " ").replace(/\s+/g, " ").trim();
            const normalizedCorrectAnswer = correctAnswer.replace(/'/g, " ").replace(/\s+/g, " ").trim();
            
            if (normalizedUserAnswer === normalizedCorrectAnswer) {
                // Bonne r√©ponse
                currentScore += 5;
                document.getElementById('currentScore').textContent = currentScore;
                
                const messages = ['Bravo !', 'C\'est super !', 'Formidable !', 'C\'est g√©nial !', 'Excellent !'];
                showMessage(messages[Math.floor(Math.random() * messages.length)], 'success');
                
                // Mettre √† jour le score total
                const totalScore = parseInt(document.getElementById('totalScore').textContent) + 5;
                const totalQuestions = parseInt(document.getElementById('totalQuestions').textContent) + 1;
                document.getElementById('totalScore').textContent = totalScore;
                document.getElementById('totalQuestions').textContent = totalQuestions;
                
                savePlayerData();
                
                // Passer √† la question suivante
                setTimeout(() => {
                    generateQuestion();
                }, 2000);
            } else {
                // Mauvaise r√©ponse
                currentScore = Math.max(0, currentScore - 5);
                document.getElementById('currentScore').textContent = currentScore;
                
                // Dire "Erreur"
                if ('speechSynthesis' in window) {
                    const errorUtterance = new SpeechSynthesisUtterance('Erreur');
                    errorUtterance.lang = 'fr-FR';
                    errorUtterance.rate = 0.8;
                    speechSynthesis.speak(errorUtterance);
                }
                
                const messages = ['Tu peux le faire !', 'Allez, continue !', 'R√©fl√©chis bien !', 'Essaye encore !', 'Ne te d√©courage pas !'];
                showMessage(messages[Math.floor(Math.random() * messages.length)], 'error');
                
                // Vider le champ pour r√©essayer
                document.getElementById('answerInput').value = '';
                document.getElementById('answerInput').focus();
            }
        }

        // Afficher un message
        function showMessage(text, type) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = `message ${type}`;
            messageEl.style.display = 'block';
        }

        // Montrer la r√©ponse
        function showAnswer() {
            const answer = currentQuestion.answer;
            showMessage(`La bonne r√©ponse est : ${answer}`, 'success');
            
            // Prononcer la r√©ponse
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(answer);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        // Afficher le tableau de conjugaison
        function showConjugation() {
            const table = document.getElementById('conjugationTable');
            const content = document.getElementById('conjugationContent');
            
            // G√©n√©rer le tableau de conjugaison
            let html = '<tr><th>Temps</th>';
            pronouns.forEach(p => html += `<th>${p.pronoun}</th>`);
            html += '</tr>';
            
            tenses[currentLevel].forEach(tense => {
                html += `<tr><td><strong>${tense}</strong></td>`;
                pronouns.forEach(pronoun => {
                    const conj = getConjugation(currentQuestion.verb, tense, pronoun.abbreviation);
                    html += `<td>${conj}</td>`;
                });
                html += '</tr>';
            });
            
            content.innerHTML = html;
            table.style.display = table.style.display === 'none' ? 'block' : 'none';
        }

        // Retour au menu
        function backToMenu() {
            if (timerInterval) clearInterval(timerInterval);
            
            // Sauvegarder le score final
            if (currentScore > 0) {
                saveScore();
            }
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('mainMenu').classList.add('active');
        }

        // Sauvegarder le score
        function saveScore() {
            const scores = JSON.parse(localStorage.getItem('conjugationScores') || '[]');
            
            if (!playerName) {
                playerName = prompt('Entre ton nom pour enregistrer ton score :') || 'Anonyme';
            }
            
            scores.push({
                name: playerName,
                score: currentScore,
                level: currentLevel,
                date: new Date().toISOString()
            });
            
            scores.sort((a, b) => b.score - a.score);
            scores.splice(10); // Garder les 10 meilleurs
            
            localStorage.setItem('conjugationScores', JSON.stringify(scores));
        }

        // Afficher les scores
        function showScores() {
            const scores = JSON.parse(localStorage.getItem('conjugationScores') || '[]');
            const list = document.getElementById('scoresList');
            
            if (scores.length === 0) {
                list.innerHTML = '<p>Aucun score enregistr√©</p>';
            } else {
                let html = '<ol style="text-align: left;">';
                scores.forEach(score => {
                    const date = new Date(score.date).toLocaleDateString('fr-FR');
                    html += `<li>${score.name} - ${score.score} points (Niveau ${score.level}) - ${date}</li>`;
                });
                html += '</ol>';
                list.innerHTML = html;
            }
            
            document.getElementById('scoresModal').style.display = 'flex';
        }

        // Fermer les scores
        function closeScores() {
            document.getElementById('scoresModal').style.display = 'none';
        }

        // Fin du jeu
        function endGame() {
            if (timerInterval) clearInterval(timerInterval);
            
            saveScore();
            
            alert(`Temps √©coul√© ! Ton score final est de ${currentScore} points.`);
            backToMenu();
        }

        // Gestionnaire d'√©v√©nements pour la touche Entr√©e
        document.getElementById('answerInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                checkAnswer();
            }
        });
    </script>
</body>
</html>